2020-06-07 22:46:18,740:INFO:STARTING TRAINING --- r1, DecisionTreeClassifier
2020-06-07 22:46:18,740:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-07 22:46:18,750:INFO:Load data set csv file
2020-06-07 22:47:23,529:INFO:Load data set csv file, time: 64.77891578990966 seconds
2020-06-07 22:47:23,532:INFO:Dataset shape: (8921483, 83)
2020-06-07 22:47:34,892:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-07 22:47:34,893:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-07 22:47:34,893:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-07 22:47:34,894:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-07 22:47:35,375:INFO:Full pipeline
2020-06-07 23:08:05,571:INFO:Full pipeline, time: 1230.1958773513325 seconds
2020-06-07 23:08:13,813:INFO:Write pipeline pickle
2020-06-07 23:08:13,818:INFO:Transformed data set shape: (8921483, 67)
2020-06-07 23:08:13,832:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-07 23:08:21,921:INFO:Training set shape (7137186, 67), test set shape (1784297, 67); total shape (8921483, 67)
2020-06-07 23:08:21,923:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-07 23:08:21,962:INFO:GridSearchCV
2020-06-07 23:14:39,582:INFO:GridSearchCV, time: 377.6199201811105 seconds
2020-06-07 23:14:39,592:INFO:Write GridSearchCV pickle
2020-06-07 23:14:39,599:INFO:CV results: {'mean_fit_time': array([121.34538965, 123.04831963, 127.8226768 , 129.01054645,
       118.7301755 , 119.79271154, 124.45227265, 124.86144218]), 'std_fit_time': array([2.11883534, 3.03790711, 1.50218138, 1.7706174 , 1.35764413,
       1.775252  , 1.54700484, 0.85163629]), 'mean_score_time': array([0.91170874, 0.92469006, 0.93786535, 0.99877911, 0.86804752,
       0.85777907, 0.75516806, 0.75279107]), 'std_score_time': array([0.0441642 , 0.05866694, 0.02364963, 0.06352779, 0.01007042,
       0.02664647, 0.01217035, 0.0074881 ]), 'param_max_depth': masked_array(data=[13, 13, 13, 13, 15, 15, 15, 15],
             mask=[False, False, False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'param_max_features': masked_array(data=[57, 57, 60, 60, 57, 57, 60, 60],
             mask=[False, False, False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'param_max_leaf_nodes': masked_array(data=[80, 83, 80, 83, 80, 83, 80, 83],
             mask=[False, False, False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'params': [{'max_depth': 13, 'max_features': 57, 'max_leaf_nodes': 80}, {'max_depth': 13, 'max_features': 57, 'max_leaf_nodes': 83}, {'max_depth': 13, 'max_features': 60, 'max_leaf_nodes': 80}, {'max_depth': 13, 'max_features': 60, 'max_leaf_nodes': 83}, {'max_depth': 15, 'max_features': 57, 'max_leaf_nodes': 80}, {'max_depth': 15, 'max_features': 57, 'max_leaf_nodes': 83}, {'max_depth': 15, 'max_features': 60, 'max_leaf_nodes': 80}, {'max_depth': 15, 'max_features': 60, 'max_leaf_nodes': 83}], 'split0_test_score': array([0.68287665, 0.68314426, 0.68300151, 0.68317339, 0.68287665,
       0.68314426, 0.68300151, 0.68317339]), 'split1_test_score': array([0.6809945 , 0.68134456, 0.68251287, 0.6828399 , 0.6809945 ,
       0.68134456, 0.68249571, 0.68284854]), 'split2_test_score': array([0.68265962, 0.68290331, 0.68320658, 0.68346958, 0.68266042,
       0.68290412, 0.68330703, 0.68358292]), 'split3_test_score': array([0.68170036, 0.68191384, 0.68247279, 0.68280234, 0.68170036,
       0.68191384, 0.68246061, 0.68291388]), 'split4_test_score': array([0.6786004 , 0.67887669, 0.6806916 , 0.68107269, 0.6786004 ,
       0.67887669, 0.6806916 , 0.68107269]), 'mean_test_score': array([0.68136631, 0.68163653, 0.68237707, 0.68267158, 0.68136647,
       0.68163669, 0.68239129, 0.68271829]), 'std_test_score': array([0.00153973, 0.00152688, 0.00088842, 0.00083552, 0.00153986,
       0.00152702, 0.00090726, 0.00086231]), 'rank_test_score': array([8, 6, 4, 2, 7, 5, 3, 1], dtype=int32), 'split0_train_score': array([0.68195878, 0.68228918, 0.68228043, 0.68255103, 0.68195878,
       0.68228918, 0.68228043, 0.68255103]), 'split1_train_score': array([0.68126915, 0.68164988, 0.68294098, 0.68337171, 0.68126915,
       0.68164988, 0.68296363, 0.68335327]), 'split2_train_score': array([0.68201719, 0.68229936, 0.68279609, 0.68304626, 0.68201803,
       0.68230021, 0.68287991, 0.68315616]), 'split3_train_score': array([0.68216894, 0.6824478 , 0.68301096, 0.68343201, 0.68216894,
       0.6824478 , 0.68300094, 0.68351001]), 'split4_train_score': array([0.67963004, 0.67988401, 0.68162269, 0.68201164, 0.67963004,
       0.67988401, 0.68162269, 0.68201164]), 'mean_train_score': array([0.68140882, 0.68171405, 0.68253023, 0.68288253, 0.68140899,
       0.68171422, 0.68254952, 0.68291642]), 'std_train_score': array([0.00094169, 0.0009555 , 0.00052087, 0.00053598, 0.0009418 ,
       0.0009556 , 0.00053214, 0.00055728])}
2020-06-07 23:14:39,613:INFO:Best score: 0.6827182851742943
2020-06-07 23:14:39,620:INFO:Refit time with the whole training set: 108.56380105018616 seconds
2020-06-07 23:14:39,626:INFO:Best parameters: {'max_depth': 15, 'max_features': 60, 'max_leaf_nodes': 83}
2020-06-07 23:14:39,632:INFO:Best estimator: DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                       max_depth=15, max_features=60, max_leaf_nodes=83,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, presort='deprecated',
                       random_state=25519, splitter='best')
2020-06-07 23:14:39,840:INFO:Predict (train)
2020-06-07 23:14:41,419:INFO:Predict (train), time: 1.5791957112960517 seconds
2020-06-07 23:14:41,829:INFO:Accuracy (train): 0.6262166910039896
2020-06-07 23:14:41,836:INFO:Predict probabilities (train)
2020-06-07 23:14:43,509:INFO:Predict probabilities (train), time: 1.6722309039905667 seconds
2020-06-07 23:14:45,173:INFO:ROC AUC (train): 0.6830576300210985
2020-06-07 23:14:46,103:INFO:Create ROC plot for train
2020-06-07 23:14:46,118:INFO:Save ROC plot for train
2020-06-07 23:14:46,471:INFO:Predict (test)
2020-06-07 23:14:46,791:INFO:Predict (test), time: 0.3198566851206124 seconds
2020-06-07 23:14:46,892:INFO:Accuracy (test): 0.6249110994414047
2020-06-07 23:14:46,899:INFO:Predict probabilities (test)
2020-06-07 23:14:47,248:INFO:Predict probabilities (test), time: 0.34952443605288863 seconds
2020-06-07 23:14:47,620:INFO:ROC AUC (test): 0.6819939697590185
2020-06-07 23:14:47,823:INFO:Create ROC plot for test
2020-06-07 23:14:47,836:INFO:Save ROC plot for test
2020-06-07 23:14:48,186:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-07 23:14:50,114:INFO:Training set shape (3568593, 67), test set shape (3568593, 67); total shape (7137186, 67)
2020-06-07 23:14:50,115:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-07 23:14:50,115:INFO:Refit with half of the training set
2020-06-07 23:15:44,034:INFO:Refit with half of the training set, time: 53.91755642229691 seconds
2020-06-07 23:15:44,042:INFO:Predict (train_50)
2020-06-07 23:15:44,699:INFO:Predict (train_50), time: 0.6567768068052828 seconds
2020-06-07 23:15:44,901:INFO:Accuracy (train_50): 0.6260834452121606
2020-06-07 23:15:44,910:INFO:Predict probabilities (train_50)
2020-06-07 23:15:45,612:INFO:Predict probabilities (train_50), time: 0.7015331340953708 seconds
2020-06-07 23:15:46,388:INFO:ROC AUC (train_50): 0.6828595462568752
2020-06-07 23:15:46,814:INFO:Create ROC plot for train_50
2020-06-07 23:15:46,884:INFO:Save ROC plot for train_50
2020-06-07 23:15:47,233:INFO:Predict (test_50)
2020-06-07 23:15:47,905:INFO:Predict (test_50), time: 0.67168482625857 seconds
2020-06-07 23:15:48,108:INFO:Accuracy (test_50): 0.6254689173015807
2020-06-07 23:15:48,115:INFO:Predict probabilities (test_50)
2020-06-07 23:15:48,821:INFO:Predict probabilities (test_50), time: 0.7055950481444597 seconds
2020-06-07 23:15:49,591:INFO:ROC AUC (test_50): 0.6824209029506447
2020-06-07 23:15:50,009:INFO:Create ROC plot for test_50
2020-06-07 23:15:50,023:INFO:Save ROC plot for test_50
2020-06-07 23:15:50,377:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-07 23:15:52,245:INFO:Training set shape (5352889, 67), test set shape (1784297, 67); total shape (7137186, 67)
2020-06-07 23:15:52,245:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-07 23:15:52,246:INFO:Refit with 3/4 of the training set
2020-06-07 23:17:09,893:INFO:Refit with 3/4 of the training set, time: 77.64685094589368 seconds
2020-06-07 23:17:09,901:INFO:Predict (train_75)
2020-06-07 23:17:11,112:INFO:Predict (train_75), time: 1.209968687966466 seconds
2020-06-07 23:17:11,422:INFO:Accuracy (train_75): 0.6260884542907578
2020-06-07 23:17:11,430:INFO:Predict probabilities (train_75)
2020-06-07 23:17:12,736:INFO:Predict probabilities (train_75), time: 1.3053015498444438 seconds
2020-06-07 23:17:14,025:INFO:ROC AUC (train_75): 0.6832114572130799
2020-06-07 23:17:14,729:INFO:Create ROC plot for train_75
2020-06-07 23:17:14,745:INFO:Save ROC plot for train_75
2020-06-07 23:17:15,095:INFO:Predict (test_75)
2020-06-07 23:17:15,556:INFO:Predict (test_75), time: 0.4600958311930299 seconds
2020-06-07 23:17:15,657:INFO:Accuracy (test_75): 0.6250719471029766
2020-06-07 23:17:15,664:INFO:Predict probabilities (test_75)
2020-06-07 23:17:16,014:INFO:Predict probabilities (test_75), time: 0.34982369327917695 seconds
2020-06-07 23:17:16,386:INFO:ROC AUC (test_75): 0.6822686591415582
2020-06-07 23:17:16,588:INFO:Create ROC plot for test_75
2020-06-07 23:17:16,601:INFO:Save ROC plot for test_75
2020-06-07 23:17:16,950:INFO:Create bar chart plot for fit
2020-06-07 23:17:16,963:INFO:Save bar chart plot for fit
2020-06-07 23:17:17,252:INFO:Create grouped bar chart plot for accuracy
2020-06-07 23:17:17,268:INFO:Save grouped bar chart plot for accuracy
2020-06-07 23:17:17,595:INFO:Create grouped bar chart plot for roc
2020-06-07 23:17:17,611:INFO:Save grouped bar chart plot for roc
2020-06-07 23:17:17,939:INFO:Final refit with the whole data set
2020-06-07 23:21:05,577:INFO:Final refit with the whole data set, time: 227.63703125808388 seconds
2020-06-07 23:21:05,586:INFO:Write refitted final model pickle
2020-06-07 23:21:05,595:INFO:Write training times in a CSV file
2020-06-07 23:21:05,603:INFO:FINISHED TRAINING --- r1, DecisionTreeClassifier
2020-06-07 23:39:54,603:INFO:STARTING PREDICTION --- r1, DecisionTreeClassifier
2020-06-07 23:39:54,603:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-07 23:39:54,613:INFO:Load data set csv file
2020-06-07 23:40:49,534:INFO:Load data set csv file, time: 54.92076024506241 seconds
2020-06-07 23:40:49,535:INFO:Dataset shape: (7853253, 82)
2020-06-07 23:40:58,925:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-07 23:40:58,926:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-07 23:40:58,926:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-07 23:40:58,927:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-07 23:40:59,129:INFO:Load pipeline pickle
2020-06-07 23:40:59,196:INFO:Pipeline transform
2020-06-07 23:59:19,441:INFO:Pipeline transform, time: 1100.2443040013313 seconds
2020-06-07 23:59:26,938:INFO:Transformed data set shape: (7853253, 67)
2020-06-07 23:59:26,945:INFO:Load model pickle
2020-06-07 23:59:26,956:INFO:Predict probabilities
2020-06-07 23:59:28,826:INFO:Predict probabilities, time: 1.8701646029949188 seconds
2020-06-07 23:59:28,872:INFO:Write predictions in a CSV file
2020-06-07 23:59:47,303:INFO:Write predictions in a CSV file, time: 18.429911075159907 seconds
2020-06-07 23:59:47,312:INFO:Write prediction times in a CSV file
2020-06-07 23:59:47,318:INFO:FINISHED PREDICTION --- r1, DecisionTreeClassifier
