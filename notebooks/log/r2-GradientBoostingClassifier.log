2020-06-14 21:31:46,313:INFO:STARTING TRAINING --- r2, GradientBoostingClassifier
2020-06-14 21:31:46,313:INFO:Number of cores: 6, NUMEXPR_MAX_THREADS = 6
2020-06-14 21:31:46,323:INFO:Load data set csv file
2020-06-14 21:32:44,435:INFO:Load data set csv file, time: 58.11129437992349 seconds
2020-06-14 21:32:44,436:INFO:Dataset shape: (8921483, 83)
2020-06-14 21:32:53,222:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-14 21:32:53,223:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-14 21:32:53,223:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-14 21:32:53,224:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-14 21:32:53,484:INFO:Full pipeline
2020-06-14 21:36:55,086:INFO:Full pipeline, time: 241.60125500708818 seconds
2020-06-14 21:37:03,034:INFO:Write pipeline pickle
2020-06-14 21:37:03,040:INFO:Transformed data set shape: (8921483, 72)
2020-06-14 21:37:03,054:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-14 21:37:12,091:INFO:Training set shape (7137186, 72), test set shape (1784297, 72); total shape (8921483, 72)
2020-06-14 21:37:12,091:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-14 21:37:12,121:INFO:GridSearchCV
2020-06-15 10:19:53,933:INFO:GridSearchCV, time: 45761.81229641661 seconds
2020-06-15 10:19:53,942:INFO:Write GridSearchCV pickle
2020-06-15 10:19:53,953:INFO:CV results: {'mean_fit_time': array([16709.91966724, 13274.59405351]), 'std_fit_time': array([684.61324137, 573.75416245]), 'mean_score_time': array([9.62574954, 7.50749183]), 'std_score_time': array([0.29415607, 0.47792479]), 'param_learning_rate': masked_array(data=[0.1, 0.3],
             mask=[False, False],
       fill_value='?',
            dtype=object), 'params': [{'learning_rate': 0.1}, {'learning_rate': 0.3}], 'split0_test_score': array([0.72280398, 0.72929383]), 'split1_test_score': array([0.72172233, 0.72851594]), 'split2_test_score': array([0.72257716, 0.72891512]), 'split3_test_score': array([0.72139581, 0.72800997]), 'split4_test_score': array([0.72137806, 0.72796038]), 'mean_test_score': array([0.72197547, 0.72853905]), 'std_test_score': array([0.00060091, 0.00051506]), 'rank_test_score': array([2, 1], dtype=int32), 'split0_train_score': array([0.72346801, 0.73285034]), 'split1_train_score': array([0.72317909, 0.73294951]), 'split2_train_score': array([0.72328992, 0.73275382]), 'split3_train_score': array([0.72340473, 0.73294905]), 'split4_train_score': array([0.72355906, 0.73285191]), 'mean_train_score': array([0.72338016, 0.73287093]), 'std_train_score': array([1.33338524e-04, 7.31815774e-05])}
2020-06-15 10:19:53,965:INFO:Best score: 0.7285390499186037
2020-06-15 10:19:53,972:INFO:Refit time with the whole training set: 15778.806781291962 seconds
2020-06-15 10:19:53,978:INFO:Best parameters: {'learning_rate': 0.3}
2020-06-15 10:19:53,984:INFO:Best estimator: GradientBoostingClassifier(ccp_alpha=0.0, criterion='friedman_mse', init=None,
                           learning_rate=0.3, loss='deviance', max_depth=13,
                           max_features=72, max_leaf_nodes=83,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, n_estimators=120,
                           n_iter_no_change=None, presort='deprecated',
                           random_state=25519, subsample=1.0, tol=0.0001,
                           validation_fraction=0.1, verbose=0, warm_start=True)
2020-06-15 10:19:54,178:INFO:Predict (train)
2020-06-15 10:20:28,795:INFO:Predict (train), time: 34.61743252631277 seconds
2020-06-15 10:20:29,206:INFO:Accuracy (train): 0.6656311044717064
2020-06-15 10:20:29,214:INFO:Predict probabilities (train)
2020-06-15 10:21:03,828:INFO:Predict probabilities (train), time: 34.61341089103371 seconds
2020-06-15 10:21:06,162:INFO:ROC AUC (train): 0.7322854457607443
2020-06-15 10:21:07,748:INFO:Create ROC plot for train
2020-06-15 10:21:07,825:INFO:Save ROC plot for train
2020-06-15 10:21:08,796:INFO:Predict (test)
2020-06-15 10:21:17,874:INFO:Predict (test), time: 9.0784951178357 seconds
2020-06-15 10:21:17,976:INFO:Accuracy (test): 0.6627596190544511
2020-06-15 10:21:17,982:INFO:Predict probabilities (test)
2020-06-15 10:21:26,795:INFO:Predict probabilities (test), time: 8.812095659784973 seconds
2020-06-15 10:21:27,294:INFO:ROC AUC (test): 0.728639091159546
2020-06-15 10:21:27,627:INFO:Create ROC plot for test
2020-06-15 10:21:27,655:INFO:Save ROC plot for test
2020-06-15 10:21:28,151:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-15 10:21:30,211:INFO:Training set shape (3568593, 72), test set shape (3568593, 72); total shape (7137186, 72)
2020-06-15 10:21:30,212:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-15 10:21:30,212:INFO:Refit with half of the training set
2020-06-15 10:21:48,162:INFO:Refit with half of the training set, time: 17.949006013572216 seconds
2020-06-15 10:21:48,168:INFO:Predict (train_50)
2020-06-15 10:22:05,679:INFO:Predict (train_50), time: 17.51037488784641 seconds
2020-06-15 10:22:05,876:INFO:Accuracy (train_50): 0.6655477382822866
2020-06-15 10:22:05,883:INFO:Predict probabilities (train_50)
2020-06-15 10:22:23,594:INFO:Predict probabilities (train_50), time: 17.71073711104691 seconds
2020-06-15 10:22:24,689:INFO:ROC AUC (train_50): 0.7322615686424981
2020-06-15 10:22:25,413:INFO:Create ROC plot for train_50
2020-06-15 10:22:25,513:INFO:Save ROC plot for train_50
2020-06-15 10:22:26,155:INFO:Predict (test_50)
2020-06-15 10:22:43,678:INFO:Predict (test_50), time: 17.523125597275794 seconds
2020-06-15 10:22:43,880:INFO:Accuracy (test_50): 0.6657144706611261
2020-06-15 10:22:43,886:INFO:Predict probabilities (test_50)
2020-06-15 10:23:01,579:INFO:Predict probabilities (test_50), time: 17.692246846854687 seconds
2020-06-15 10:23:02,670:INFO:ROC AUC (test_50): 0.7323090837247025
2020-06-15 10:23:03,391:INFO:Create ROC plot for test_50
2020-06-15 10:23:03,436:INFO:Save ROC plot for test_50
2020-06-15 10:23:04,081:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-15 10:23:05,976:INFO:Training set shape (5352889, 72), test set shape (1784297, 72); total shape (7137186, 72)
2020-06-15 10:23:05,976:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-15 10:23:05,977:INFO:Refit with 3/4 of the training set
2020-06-15 10:23:32,323:INFO:Refit with 3/4 of the training set, time: 26.344847219996154 seconds
2020-06-15 10:23:32,332:INFO:Predict (train_75)
2020-06-15 10:23:58,330:INFO:Predict (train_75), time: 25.997651616111398 seconds
2020-06-15 10:23:58,643:INFO:Accuracy (train_75): 0.6656917414129081
2020-06-15 10:23:58,651:INFO:Predict probabilities (train_75)
2020-06-15 10:24:24,621:INFO:Predict probabilities (train_75), time: 25.970556996762753 seconds
2020-06-15 10:24:26,348:INFO:ROC AUC (train_75): 0.7323989661480911
2020-06-15 10:24:27,516:INFO:Create ROC plot for train_75
2020-06-15 10:24:27,580:INFO:Save ROC plot for train_75
2020-06-15 10:24:28,387:INFO:Predict (test_75)
2020-06-15 10:24:37,249:INFO:Predict (test_75), time: 8.861689110286534 seconds
2020-06-15 10:24:37,348:INFO:Accuracy (test_75): 0.6654491937160686
2020-06-15 10:24:37,354:INFO:Predict probabilities (test_75)
2020-06-15 10:24:46,055:INFO:Predict probabilities (test_75), time: 8.70065198559314 seconds
2020-06-15 10:24:46,556:INFO:ROC AUC (test_75): 0.7319448229181668
2020-06-15 10:24:46,892:INFO:Create ROC plot for test_75
2020-06-15 10:24:46,922:INFO:Save ROC plot for test_75
2020-06-15 10:24:47,416:INFO:Create bar chart plot for fit
2020-06-15 10:24:47,430:INFO:Save bar chart plot for fit
2020-06-15 10:24:47,738:INFO:Create grouped bar chart plot for accuracy
2020-06-15 10:24:47,755:INFO:Save grouped bar chart plot for accuracy
2020-06-15 10:24:48,082:INFO:Create grouped bar chart plot for roc
2020-06-15 10:24:48,098:INFO:Save grouped bar chart plot for roc
2020-06-15 10:24:48,425:INFO:Final refit with the whole data set
2020-06-15 10:25:34,382:INFO:Final refit with the whole data set, time: 45.95701538026333 seconds
2020-06-15 10:25:34,391:INFO:Write refitted final model pickle
2020-06-15 10:25:34,406:INFO:Write training times in a CSV file
2020-06-15 10:25:34,414:INFO:FINISHED TRAINING --- r2, GradientBoostingClassifier
2020-06-15 14:50:19,437:INFO:STARTING PREDICTION --- r2, GradientBoostingClassifier
2020-06-15 14:50:19,438:INFO:Number of cores: 6, NUMEXPR_MAX_THREADS = 6
2020-06-15 14:50:19,448:INFO:Load data set csv file
2020-06-15 14:51:09,610:INFO:Load data set csv file, time: 50.16184914391488 seconds
2020-06-15 14:51:09,611:INFO:Dataset shape: (7853253, 82)
2020-06-15 14:51:16,866:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-15 14:51:16,867:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-15 14:51:16,867:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-15 14:51:16,868:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-15 14:51:17,067:INFO:Load pipeline pickle
2020-06-15 14:51:17,131:INFO:Pipeline transform
2020-06-15 14:54:36,982:INFO:Pipeline transform, time: 199.8507902054116 seconds
2020-06-15 14:54:43,542:INFO:Transformed data set shape: (7853253, 72)
2020-06-15 14:54:43,549:INFO:Load model pickle
2020-06-15 14:54:43,570:INFO:Predict probabilities
2020-06-15 14:55:21,134:INFO:Predict probabilities, time: 37.56384533364326 seconds
2020-06-15 14:55:21,182:INFO:Write predictions in a CSV file
2020-06-15 14:55:40,075:INFO:Write predictions in a CSV file, time: 18.892299852333963 seconds
2020-06-15 14:55:40,086:INFO:Write prediction times in a CSV file
2020-06-15 14:55:40,093:INFO:FINISHED PREDICTION --- r2, GradientBoostingClassifier
