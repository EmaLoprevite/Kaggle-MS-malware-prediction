2020-06-08 11:14:04,926:INFO:STARTING TRAINING --- r1, RandomForestClassifier
2020-06-08 11:14:04,926:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-08 11:14:04,937:INFO:Load data set csv file
2020-06-08 11:15:09,256:INFO:Load data set csv file, time: 64.31842644372955 seconds
2020-06-08 11:15:09,258:INFO:Dataset shape: (8921483, 83)
2020-06-08 11:15:20,881:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-08 11:15:20,882:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-08 11:15:20,882:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-08 11:15:20,883:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-08 11:15:21,180:INFO:Full pipeline
2020-06-08 11:37:54,782:INFO:Full pipeline, time: 1353.6008362639695 seconds
2020-06-08 11:38:03,192:INFO:Write pipeline pickle
2020-06-08 11:38:03,198:INFO:Transformed data set shape: (8921483, 67)
2020-06-08 11:38:03,212:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-08 11:38:11,466:INFO:Training set shape (7137186, 67), test set shape (1784297, 67); total shape (8921483, 67)
2020-06-08 11:38:11,467:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-08 11:38:11,499:INFO:GridSearchCV
2020-06-08 15:48:25,157:INFO:GridSearchCV, time: 15013.657734717242 seconds
2020-06-08 15:48:25,169:INFO:Write GridSearchCV pickle
2020-06-08 15:48:25,183:INFO:CV results: {'mean_fit_time': array([7196.76619754, 7729.70675836, 8183.77974405, 7502.98879995,
       4530.30242548, 4542.73340878]), 'std_fit_time': array([ 28.83022912,  72.39910176,  54.6411145 ,  32.21928459,
       139.5776206 ,  68.00358976]), 'mean_score_time': array([10.87953   , 11.68967795, 10.18970971, 10.79374166,  6.2535109 ,
        5.5664587 ]), 'std_score_time': array([0.94526986, 0.69500611, 1.0028483 , 0.61286027, 0.46712185,
       0.35145561]), 'param_max_features': masked_array(data=[60, 60, 60, 63, 63, 63],
             mask=[False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'param_n_estimators': masked_array(data=[110, 120, 130, 110, 120, 130],
             mask=[False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'params': [{'max_features': 60, 'n_estimators': 110}, {'max_features': 60, 'n_estimators': 120}, {'max_features': 60, 'n_estimators': 130}, {'max_features': 63, 'n_estimators': 110}, {'max_features': 63, 'n_estimators': 120}, {'max_features': 63, 'n_estimators': 130}], 'split0_test_score': array([0.68776064, 0.68776218, 0.68772295, 0.68716147, 0.68723094,
       0.68724926]), 'split1_test_score': array([0.68714774, 0.68719041, 0.68717571, 0.6862099 , 0.68624879,
       0.68631243]), 'split2_test_score': array([0.68782384, 0.68784143, 0.68784823, 0.68726036, 0.68728862,
       0.68733377]), 'split3_test_score': array([0.68676674, 0.68685808, 0.6868338 , 0.68617528, 0.68614348,
       0.68625962]), 'split4_test_score': array([0.68646282, 0.68655785, 0.68653031, 0.68585518, 0.68584991,
       0.6858526 ]), 'mean_test_score': array([0.68719236, 0.68724199, 0.6872222 , 0.68653244, 0.68655235,
       0.68660154]), 'std_test_score': array([0.00053611, 0.0004996 , 0.00050486, 0.00056848, 0.00059251,
       0.00058602]), 'rank_test_score': array([3, 1, 2, 6, 5, 4], dtype=int32), 'split0_train_score': array([0.68696788, 0.68696646, 0.68693226, 0.68637086, 0.68643894,
       0.68645555]), 'split1_train_score': array([0.68767632, 0.68771808, 0.68770019, 0.68678697, 0.68681603,
       0.68687585]), 'split2_train_score': array([0.68730804, 0.68732451, 0.6873305 , 0.68671685, 0.68674563,
       0.68678928]), 'split3_train_score': array([0.68731534, 0.68740166, 0.68737701, 0.68673632, 0.68670502,
       0.68682056]), 'split4_train_score': array([0.68749706, 0.68760254, 0.68757552, 0.68691208, 0.68690727,
       0.68690726]), 'mean_train_score': array([0.68735293, 0.68740265, 0.6873831 , 0.68670461, 0.68672258,
       0.6867697 ]), 'std_train_score': array([0.00023539, 0.00025916, 0.00026216, 0.00018021, 0.00015757,
       0.00016239])}
2020-06-08 15:48:25,197:INFO:Best score: 0.6872419897498331
2020-06-08 15:48:25,204:INFO:Refit time with the whole training set: 2723.507874250412 seconds
2020-06-08 15:48:25,212:INFO:Best parameters: {'max_features': 60, 'n_estimators': 120}
2020-06-08 15:48:25,218:INFO:Best estimator: RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion='gini', max_depth=15, max_features=60,
                       max_leaf_nodes=83, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=120, n_jobs=4,
                       oob_score=False, random_state=25519, verbose=0,
                       warm_start=False)
2020-06-08 15:48:25,431:INFO:Predict (train)
2020-06-08 15:48:48,262:INFO:Predict (train), time: 22.83040173817426 seconds
2020-06-08 15:48:48,667:INFO:Accuracy (train): 0.6307952461936679
2020-06-08 15:48:48,675:INFO:Predict probabilities (train)
2020-06-08 15:49:10,961:INFO:Predict probabilities (train), time: 22.285466202069074 seconds
2020-06-08 15:49:12,960:INFO:ROC AUC (train): 0.6873662312342099
2020-06-08 15:49:14,171:INFO:Create ROC plot for train
2020-06-08 15:49:14,199:INFO:Save ROC plot for train
2020-06-08 15:49:14,604:INFO:Predict (test)
2020-06-08 15:49:19,560:INFO:Predict (test), time: 4.955511150881648 seconds
2020-06-08 15:49:19,666:INFO:Accuracy (test): 0.6299130694049253
2020-06-08 15:49:19,674:INFO:Predict probabilities (test)
2020-06-08 15:49:24,526:INFO:Predict probabilities (test), time: 4.851653564255685 seconds
2020-06-08 15:49:24,965:INFO:ROC AUC (test): 0.6865713062657848
2020-06-08 15:49:25,217:INFO:Create ROC plot for test
2020-06-08 15:49:25,237:INFO:Save ROC plot for test
2020-06-08 15:49:25,615:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-08 15:49:27,766:INFO:Training set shape (3568593, 67), test set shape (3568593, 67); total shape (7137186, 67)
2020-06-08 15:49:27,767:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-08 15:49:27,767:INFO:Refit with half of the training set
2020-06-08 16:17:23,813:INFO:Refit with half of the training set, time: 1676.0451753768139 seconds
2020-06-08 16:17:23,823:INFO:Predict (train_50)
2020-06-08 16:17:33,743:INFO:Predict (train_50), time: 9.91940796887502 seconds
2020-06-08 16:17:33,946:INFO:Accuracy (train_50): 0.6314687609374339
2020-06-08 16:17:33,953:INFO:Predict probabilities (train_50)
2020-06-08 16:17:44,192:INFO:Predict probabilities (train_50), time: 10.238400406204164 seconds
2020-06-08 16:17:45,280:INFO:ROC AUC (train_50): 0.6875511907957512
2020-06-08 16:17:45,878:INFO:Create ROC plot for train_50
2020-06-08 16:17:45,901:INFO:Save ROC plot for train_50
2020-06-08 16:17:46,314:INFO:Predict (test_50)
2020-06-08 16:17:56,676:INFO:Predict (test_50), time: 10.361190625000745 seconds
2020-06-08 16:17:56,881:INFO:Accuracy (test_50): 0.6308121996540373
2020-06-08 16:17:56,889:INFO:Predict probabilities (test_50)
2020-06-08 16:18:07,227:INFO:Predict probabilities (test_50), time: 10.337537387851626 seconds
2020-06-08 16:18:08,225:INFO:ROC AUC (test_50): 0.6869567397336647
2020-06-08 16:18:08,872:INFO:Create ROC plot for test_50
2020-06-08 16:18:08,897:INFO:Save ROC plot for test_50
2020-06-08 16:18:09,307:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-08 16:18:11,489:INFO:Training set shape (5352889, 67), test set shape (1784297, 67); total shape (7137186, 67)
2020-06-08 16:18:11,490:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-08 16:18:11,491:INFO:Refit with 3/4 of the training set
2020-06-08 16:56:14,878:INFO:Refit with 3/4 of the training set, time: 2283.3865801119246 seconds
2020-06-08 16:56:14,891:INFO:Predict (train_75)
2020-06-08 16:56:30,881:INFO:Predict (train_75), time: 15.989441459067166 seconds
2020-06-08 16:56:31,206:INFO:Accuracy (train_75): 0.6313416923085833
2020-06-08 16:56:31,215:INFO:Predict probabilities (train_75)
2020-06-08 16:56:46,594:INFO:Predict probabilities (train_75), time: 15.379397846758366 seconds
2020-06-08 16:56:48,312:INFO:ROC AUC (train_75): 0.6878097561810407
2020-06-08 16:56:49,312:INFO:Create ROC plot for train_75
2020-06-08 16:56:49,341:INFO:Save ROC plot for train_75
2020-06-08 16:56:49,765:INFO:Predict (test_75)
2020-06-08 16:56:55,436:INFO:Predict (test_75), time: 5.670791942160577 seconds
2020-06-08 16:56:55,539:INFO:Accuracy (test_75): 0.630375996821157
2020-06-08 16:56:55,547:INFO:Predict probabilities (test_75)
2020-06-08 16:57:00,983:INFO:Predict probabilities (test_75), time: 5.435454972088337 seconds
2020-06-08 16:57:01,455:INFO:ROC AUC (test_75): 0.6867869657468085
2020-06-08 16:57:01,738:INFO:Create ROC plot for test_75
2020-06-08 16:57:01,762:INFO:Save ROC plot for test_75
2020-06-08 16:57:02,176:INFO:Create bar chart plot for fit
2020-06-08 16:57:02,191:INFO:Save bar chart plot for fit
2020-06-08 16:57:02,509:INFO:Create grouped bar chart plot for accuracy
2020-06-08 16:57:02,527:INFO:Save grouped bar chart plot for accuracy
2020-06-08 16:57:02,878:INFO:Create grouped bar chart plot for roc
2020-06-08 16:57:02,895:INFO:Save grouped bar chart plot for roc
2020-06-08 16:57:03,251:INFO:Final refit with the whole data set
2020-06-08 17:52:25,669:INFO:Final refit with the whole data set, time: 3322.4170742826536 seconds
2020-06-08 17:52:25,678:INFO:Write refitted final model pickle
2020-06-08 17:52:25,697:INFO:Write training times in a CSV file
2020-06-08 17:52:25,705:INFO:FINISHED TRAINING --- r1, RandomForestClassifier
2020-06-08 19:04:29,740:INFO:STARTING PREDICTION --- r1, RandomForestClassifier
2020-06-08 19:04:29,740:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-08 19:04:29,750:INFO:Load data set csv file
2020-06-08 19:05:22,085:INFO:Load data set csv file, time: 52.334486834239215 seconds
2020-06-08 19:05:22,087:INFO:Dataset shape: (7853253, 82)
2020-06-08 19:05:32,094:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-08 19:05:32,095:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-08 19:05:32,095:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-08 19:05:32,096:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-08 19:05:32,311:INFO:Load pipeline pickle
2020-06-08 19:05:32,382:INFO:Pipeline transform
2020-06-08 19:24:40,960:INFO:Pipeline transform, time: 1148.5770564130507 seconds
2020-06-08 19:24:47,874:INFO:Transformed data set shape: (7853253, 67)
2020-06-08 19:24:47,882:INFO:Load model pickle
2020-06-08 19:24:47,905:INFO:Predict probabilities
2020-06-08 19:25:11,685:INFO:Predict probabilities, time: 23.780449917074293 seconds
2020-06-08 19:25:11,747:INFO:Write predictions in a CSV file
2020-06-08 19:25:31,507:INFO:Write predictions in a CSV file, time: 19.75931075727567 seconds
2020-06-08 19:25:31,517:INFO:Write prediction times in a CSV file
2020-06-08 19:25:31,523:INFO:FINISHED PREDICTION --- r1, RandomForestClassifier
