2020-06-10 22:24:41,118:INFO:STARTING TRAINING --- r1, GradientBoostingClassifier
2020-06-10 22:24:41,118:INFO:Number of cores: 6, NUMEXPR_MAX_THREADS = 6
2020-06-10 22:24:41,128:INFO:Load data set csv file
2020-06-10 22:25:41,369:INFO:Load data set csv file, time: 60.240048337727785 seconds
2020-06-10 22:25:41,371:INFO:Dataset shape: (8921483, 83)
2020-06-10 22:25:52,205:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-10 22:25:52,206:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-10 22:25:52,206:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-10 22:25:52,207:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-10 22:25:52,488:INFO:Full pipeline
2020-06-10 22:46:32,327:INFO:Full pipeline, time: 1239.838205323089 seconds
2020-06-10 22:46:40,334:INFO:Write pipeline pickle
2020-06-10 22:46:40,339:INFO:Transformed data set shape: (8921483, 67)
2020-06-10 22:46:40,353:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-10 22:46:48,320:INFO:Training set shape (7137186, 67), test set shape (1784297, 67); total shape (8921483, 67)
2020-06-10 22:46:48,320:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-10 22:46:48,349:INFO:GridSearchCV
2020-06-12 06:58:54,389:INFO:GridSearchCV, time: 115926.0397475618 seconds
2020-06-12 06:58:54,399:INFO:Write GridSearchCV pickle
2020-06-12 06:58:54,411:INFO:CV results: {'mean_fit_time': array([14039.09335637, 15432.07796307, 16723.98531537, 11806.94675608,
       12512.06938801, 13278.01384263, 10047.49854369, 10536.1992835 ,
       10719.66820855]), 'std_fit_time': array([143.09234705, 203.72286787, 146.57249381, 330.59240099,
       235.76736997, 285.78112051, 258.0249775 , 370.11701985,
       460.07479384]), 'mean_score_time': array([ 8.83142376,  9.45007176, 10.01554284,  7.34118748,  7.9995914 ,
        8.3585382 ,  6.72312641,  7.10013523,  6.9417891 ]), 'std_score_time': array([0.03801135, 0.05813063, 0.08365996, 0.11729573, 0.16148584,
       0.10479545, 0.11929209, 0.15997491, 0.30179855]), 'param_learning_rate': masked_array(data=[0.1, 0.1, 0.1, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5],
             mask=[False, False, False, False, False, False, False, False,
                   False],
       fill_value='?',
            dtype=object), 'param_n_estimators': masked_array(data=[110, 120, 130, 110, 120, 130, 110, 120, 130],
             mask=[False, False, False, False, False, False, False, False,
                   False],
       fill_value='?',
            dtype=object), 'params': [{'learning_rate': 0.1, 'n_estimators': 110}, {'learning_rate': 0.1, 'n_estimators': 120}, {'learning_rate': 0.1, 'n_estimators': 130}, {'learning_rate': 0.3, 'n_estimators': 110}, {'learning_rate': 0.3, 'n_estimators': 120}, {'learning_rate': 0.3, 'n_estimators': 130}, {'learning_rate': 0.5, 'n_estimators': 110}, {'learning_rate': 0.5, 'n_estimators': 120}, {'learning_rate': 0.5, 'n_estimators': 130}], 'split0_test_score': array([0.72177164, 0.72274974, 0.72345013, 0.72859656, 0.72906911,
       0.72968472, 0.72812587, 0.72846935, 0.72845745]), 'split1_test_score': array([0.72089042, 0.72173374, 0.72255865, 0.72733806, 0.72780606,
       0.72805207, 0.72768023, 0.72808319, 0.72800697]), 'split2_test_score': array([0.72175592, 0.72271117, 0.72342668, 0.72832664, 0.72870359,
       0.72886249, 0.7286136 , 0.7288127 , 0.72895831]), 'split3_test_score': array([0.72061224, 0.72150364, 0.72232102, 0.72766511, 0.7280706 ,
       0.72828714, 0.72735565, 0.72762135, 0.72781249]), 'split4_test_score': array([0.72052613, 0.72137772, 0.722217  , 0.7271739 , 0.72763843,
       0.72799251, 0.72692524, 0.72711733, 0.72714539]), 'mean_test_score': array([0.72111127, 0.7220152 , 0.7227947 , 0.72782006, 0.72825756,
       0.72857579, 0.72774012, 0.72802078, 0.72807612]), 'std_test_score': array([0.00054623, 0.00059518, 0.00053718, 0.00055379, 0.000544  ,
       0.00063399, 0.00058774, 0.00060133, 0.00061061]), 'rank_test_score': array([9, 8, 7, 5, 2, 1, 6, 4, 3], dtype=int32), 'split0_train_score': array([0.72234254, 0.7234223 , 0.72424205, 0.73180099, 0.73268017,
       0.73371483, 0.73420917, 0.73527785, 0.73602578]), 'split1_train_score': array([0.72226777, 0.72320657, 0.72411654, 0.73157234, 0.73243689,
       0.73318496, 0.73480298, 0.73589953, 0.7366653 ]), 'split2_train_score': array([0.72224343, 0.72330902, 0.72414804, 0.7315423 , 0.73233986,
       0.73301236, 0.73476419, 0.73574567, 0.73664683]), 'split3_train_score': array([0.7225274 , 0.72352168, 0.7244433 , 0.73231166, 0.73316411,
       0.73385073, 0.7346768 , 0.73568233, 0.73661508]), 'split4_train_score': array([0.7225019 , 0.72346049, 0.72437886, 0.73181003, 0.73272527,
       0.73351573, 0.73470893, 0.73559538, 0.736392  ]), 'mean_train_score': array([0.72237661, 0.72338401, 0.72426576, 0.73180746, 0.73266926,
       0.73345572, 0.73463241, 0.73564015, 0.736469  ]), 'std_train_score': array([0.00011763, 0.00011259, 0.00012728, 0.00027563, 0.00028658,
       0.00031517, 0.00021607, 0.00020662, 0.00024244])}
2020-06-12 06:58:54,427:INFO:Best score: 0.7285757859682771
2020-06-12 06:58:54,434:INFO:Refit time with the whole training set: 15124.88409280777 seconds
2020-06-12 06:58:54,440:INFO:Best parameters: {'learning_rate': 0.3, 'n_estimators': 130}
2020-06-12 06:58:54,447:INFO:Best estimator: GradientBoostingClassifier(ccp_alpha=0.0, criterion='friedman_mse', init=None,
                           learning_rate=0.3, loss='deviance', max_depth=15,
                           max_features=60, max_leaf_nodes=83,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, n_estimators=130,
                           n_iter_no_change=None, presort='deprecated',
                           random_state=25519, subsample=1.0, tol=0.0001,
                           validation_fraction=0.1, verbose=0, warm_start=True)
2020-06-12 06:58:54,653:INFO:Predict (train)
2020-06-12 06:59:31,893:INFO:Predict (train), time: 37.23965290701017 seconds
2020-06-12 06:59:32,313:INFO:Accuracy (train): 0.6659135687370344
2020-06-12 06:59:32,322:INFO:Predict probabilities (train)
2020-06-12 07:00:09,362:INFO:Predict probabilities (train), time: 37.03923784289509 seconds
2020-06-12 07:00:11,862:INFO:ROC AUC (train): 0.7327120774244581
2020-06-12 07:00:13,534:INFO:Create ROC plot for train
2020-06-12 07:00:13,616:INFO:Save ROC plot for train
2020-06-12 07:00:14,622:INFO:Predict (test)
2020-06-12 07:00:24,025:INFO:Predict (test), time: 9.40221962891519 seconds
2020-06-12 07:00:24,128:INFO:Accuracy (test): 0.6626155847372943
2020-06-12 07:00:24,134:INFO:Predict probabilities (test)
2020-06-12 07:00:33,451:INFO:Predict probabilities (test), time: 9.315947852563113 seconds
2020-06-12 07:00:33,979:INFO:ROC AUC (test): 0.728400401444702
2020-06-12 07:00:34,326:INFO:Create ROC plot for test
2020-06-12 07:00:34,357:INFO:Save ROC plot for test
2020-06-12 07:00:34,882:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-12 07:00:36,899:INFO:Training set shape (3568593, 67), test set shape (3568593, 67); total shape (7137186, 67)
2020-06-12 07:00:36,900:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-12 07:00:36,901:INFO:Refit with half of the training set
2020-06-12 07:00:56,181:INFO:Refit with half of the training set, time: 19.27972116228193 seconds
2020-06-12 07:00:56,187:INFO:Predict (train_50)
2020-06-12 07:01:14,831:INFO:Predict (train_50), time: 18.64366668416187 seconds
2020-06-12 07:01:15,037:INFO:Accuracy (train_50): 0.6659459344341033
2020-06-12 07:01:15,043:INFO:Predict probabilities (train_50)
2020-06-12 07:01:33,643:INFO:Predict probabilities (train_50), time: 18.59978077793494 seconds
2020-06-12 07:01:34,791:INFO:ROC AUC (train_50): 0.7326560335862103
2020-06-12 07:01:35,553:INFO:Create ROC plot for train_50
2020-06-12 07:01:35,661:INFO:Save ROC plot for train_50
2020-06-12 07:01:36,337:INFO:Predict (test_50)
2020-06-12 07:01:55,097:INFO:Predict (test_50), time: 18.759859063196927 seconds
2020-06-12 07:01:55,306:INFO:Accuracy (test_50): 0.6658812030399656
2020-06-12 07:01:55,314:INFO:Predict probabilities (test_50)
2020-06-12 07:02:13,916:INFO:Predict probabilities (test_50), time: 18.602048066910356 seconds
2020-06-12 07:02:15,044:INFO:ROC AUC (test_50): 0.7327680996318613
2020-06-12 07:02:15,792:INFO:Create ROC plot for test_50
2020-06-12 07:02:15,840:INFO:Save ROC plot for test_50
2020-06-12 07:02:16,512:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-12 07:02:18,335:INFO:Training set shape (5352889, 67), test set shape (1784297, 67); total shape (7137186, 67)
2020-06-12 07:02:18,336:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-12 07:02:18,336:INFO:Refit with 3/4 of the training set
2020-06-12 07:02:46,275:INFO:Refit with 3/4 of the training set, time: 27.93828610703349 seconds
2020-06-12 07:02:46,282:INFO:Predict (train_75)
2020-06-12 07:03:14,055:INFO:Predict (train_75), time: 27.773140157107264 seconds
2020-06-12 07:03:14,376:INFO:Accuracy (train_75): 0.6659252601725909
2020-06-12 07:03:14,385:INFO:Predict probabilities (train_75)
2020-06-12 07:03:41,915:INFO:Predict probabilities (train_75), time: 27.5300355469808 seconds
2020-06-12 07:03:43,820:INFO:ROC AUC (train_75): 0.7328068726595692
2020-06-12 07:03:45,021:INFO:Create ROC plot for train_75
2020-06-12 07:03:45,088:INFO:Save ROC plot for train_75
2020-06-12 07:03:45,918:INFO:Predict (test_75)
2020-06-12 07:03:55,243:INFO:Predict (test_75), time: 9.325156620703638 seconds
2020-06-12 07:03:55,349:INFO:Accuracy (test_75): 0.6658784944434699
2020-06-12 07:03:55,358:INFO:Predict probabilities (test_75)
2020-06-12 07:04:04,599:INFO:Predict probabilities (test_75), time: 9.241383992601186 seconds
2020-06-12 07:04:05,129:INFO:ROC AUC (test_75): 0.7324274394604907
2020-06-12 07:04:05,477:INFO:Create ROC plot for test_75
2020-06-12 07:04:05,508:INFO:Save ROC plot for test_75
2020-06-12 07:04:06,025:INFO:Create bar chart plot for fit
2020-06-12 07:04:06,040:INFO:Save bar chart plot for fit
2020-06-12 07:04:06,362:INFO:Create grouped bar chart plot for accuracy
2020-06-12 07:04:06,380:INFO:Save grouped bar chart plot for accuracy
2020-06-12 07:04:06,725:INFO:Create grouped bar chart plot for roc
2020-06-12 07:04:06,743:INFO:Save grouped bar chart plot for roc
2020-06-12 07:04:07,087:INFO:Final refit with the whole data set
2020-06-12 07:04:56,275:INFO:Final refit with the whole data set, time: 49.18761803722009 seconds
2020-06-12 07:04:56,285:INFO:Write refitted final model pickle
2020-06-12 07:04:56,300:INFO:Write training times in a CSV file
2020-06-12 07:04:56,308:INFO:FINISHED TRAINING --- r1, GradientBoostingClassifier
2020-06-12 11:39:29,082:INFO:STARTING PREDICTION --- r1, GradientBoostingClassifier
2020-06-12 11:39:29,082:INFO:Number of cores: 6, NUMEXPR_MAX_THREADS = 6
2020-06-12 11:39:29,093:INFO:Load data set csv file
2020-06-12 11:40:22,734:INFO:Load data set csv file, time: 53.640126306097955 seconds
2020-06-12 11:40:22,735:INFO:Dataset shape: (7853253, 82)
2020-06-12 11:40:32,493:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_SystemVolumeTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-12 11:40:32,494:INFO:Boolen columns: ['IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-12 11:40:32,494:INFO:Numeric bin columns: ['RtpStateBitfield', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-12 11:40:32,495:INFO:String columns: ['EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-12 11:40:32,712:INFO:Load pipeline pickle
2020-06-12 11:40:32,798:INFO:Pipeline transform
2020-06-12 12:00:09,657:INFO:Pipeline transform, time: 1176.858280134853 seconds
2020-06-12 12:00:17,276:INFO:Transformed data set shape: (7853253, 67)
2020-06-12 12:00:17,283:INFO:Load model pickle
2020-06-12 12:00:17,307:INFO:Predict probabilities
2020-06-12 12:00:59,331:INFO:Predict probabilities, time: 42.024485900998116 seconds
2020-06-12 12:00:59,384:INFO:Write predictions in a CSV file
2020-06-12 12:01:19,938:INFO:Write predictions in a CSV file, time: 20.55349543876946 seconds
2020-06-12 12:01:19,949:INFO:Write prediction times in a CSV file
2020-06-12 12:01:19,957:INFO:FINISHED PREDICTION --- r1, GradientBoostingClassifier
