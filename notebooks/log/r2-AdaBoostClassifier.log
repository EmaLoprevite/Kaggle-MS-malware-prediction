2020-06-13 01:56:34,820:INFO:STARTING TRAINING --- r2, AdaBoostClassifier
2020-06-13 01:56:34,820:INFO:Number of cores: 10, NUMEXPR_MAX_THREADS = 10
2020-06-13 01:56:34,831:INFO:Load data set csv file
2020-06-13 01:57:34,148:INFO:Load data set csv file, time: 59.31682871282101 seconds
2020-06-13 01:57:34,151:INFO:Dataset shape: (8921483, 83)
2020-06-13 01:57:42,954:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-13 01:57:42,955:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-13 01:57:42,955:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-13 01:57:42,956:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-13 01:57:43,236:INFO:Full pipeline
2020-06-13 02:01:53,116:INFO:Full pipeline, time: 249.88000059034675 seconds
2020-06-13 02:02:01,434:INFO:Write pipeline pickle
2020-06-13 02:02:01,440:INFO:Transformed data set shape: (8921483, 72)
2020-06-13 02:02:01,454:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-13 02:02:10,271:INFO:Training set shape (7137186, 72), test set shape (1784297, 72); total shape (8921483, 72)
2020-06-13 02:02:10,272:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-13 02:02:10,303:INFO:GridSearchCV
2020-06-13 14:49:05,150:INFO:GridSearchCV, time: 46014.84573427914 seconds
2020-06-13 14:49:05,159:INFO:Write GridSearchCV pickle
2020-06-13 14:49:05,172:INFO:CV results: {'mean_fit_time': array([ 6767.23190827,  9372.93921385, 11617.58040619,  6655.41297479,
        9343.1949122 , 11126.16815386]), 'std_fit_time': array([176.16628986, 244.76036521, 340.10986942, 262.059329  ,
       138.14665006, 190.26867039]), 'mean_score_time': array([26.12656431, 43.10604119, 58.92890782, 25.78485188, 41.34956465,
       53.42062554]), 'std_score_time': array([0.45934653, 0.87734145, 0.4892197 , 0.14128159, 0.59739835,
       1.45228147]), 'param_learning_rate': masked_array(data=[0.7, 0.7, 0.7, 1.0, 1.0, 1.0],
             mask=[False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'param_n_estimators': masked_array(data=[50, 85, 120, 50, 85, 120],
             mask=[False, False, False, False, False, False],
       fill_value='?',
            dtype=object), 'params': [{'learning_rate': 0.7, 'n_estimators': 50}, {'learning_rate': 0.7, 'n_estimators': 85}, {'learning_rate': 0.7, 'n_estimators': 120}, {'learning_rate': 1.0, 'n_estimators': 50}, {'learning_rate': 1.0, 'n_estimators': 85}, {'learning_rate': 1.0, 'n_estimators': 120}], 'split0_test_score': array([0.72359624, 0.72589511, 0.72645262, 0.72130957, 0.72262114,
       0.72189385]), 'split1_test_score': array([0.72406177, 0.72557081, 0.7263183 , 0.71877415, 0.72130612,
       0.72108638]), 'split2_test_score': array([0.72400939, 0.7255494 , 0.72606934, 0.72121943, 0.7220542 ,
       0.72156776]), 'split3_test_score': array([0.72193378, 0.72455704, 0.72528873, 0.71989431, 0.72083067,
       0.72085861]), 'split4_test_score': array([0.72243134, 0.72473389, 0.72490521, 0.72074497, 0.72195309,
       0.72169639]), 'mean_test_score': array([0.7232065 , 0.72526125, 0.72580684, 0.72038849, 0.72175304,
       0.7214206 ]), 'std_test_score': array([0.00086588, 0.00052051, 0.0006048 , 0.0009504 , 0.00062206,
       0.0003871 ]), 'rank_test_score': array([3, 2, 1, 6, 4, 5], dtype=int32), 'split0_train_score': array([0.72667705, 0.73184972, 0.73541629, 0.72555306, 0.73057285,
       0.73418889]), 'split1_train_score': array([0.7274796 , 0.73212295, 0.73606437, 0.72409061, 0.73026343,
       0.73403269]), 'split2_train_score': array([0.72707102, 0.73178103, 0.73536559, 0.72527618, 0.73020916,
       0.733766  ]), 'split3_train_score': array([0.72635356, 0.7318167 , 0.73556001, 0.72522493, 0.73007508,
       0.73408407]), 'split4_train_score': array([0.72695461, 0.73217949, 0.73554477, 0.72627615, 0.7315945 ,
       0.73499678]), 'mean_train_score': array([0.72690717, 0.73194998, 0.73559021, 0.72528419, 0.730543  ,
       0.73421369]), 'std_train_score': array([0.00037847, 0.00016671, 0.0002484 , 0.00070491, 0.00055047,
       0.00041565])}
2020-06-13 14:49:05,185:INFO:Best score: 0.7258068407670023
2020-06-13 14:49:05,194:INFO:Refit time with the whole training set: 15331.450209140778 seconds
2020-06-13 14:49:05,200:INFO:Best parameters: {'learning_rate': 0.7, 'n_estimators': 120}
2020-06-13 14:49:05,206:INFO:Best estimator: AdaBoostClassifier(algorithm='SAMME.R',
                   base_estimator=DecisionTreeClassifier(ccp_alpha=0.0,
                                                         class_weight=None,
                                                         criterion='gini',
                                                         max_depth=13,
                                                         max_features=72,
                                                         max_leaf_nodes=83,
                                                         min_impurity_decrease=0.0,
                                                         min_impurity_split=None,
                                                         min_samples_leaf=1,
                                                         min_samples_split=2,
                                                         min_weight_fraction_leaf=0.0,
                                                         presort='deprecated',
                                                         random_state=25519,
                                                         splitter='best'),
                   learning_rate=0.7, n_estimators=120, random_state=25519)
2020-06-13 14:49:05,405:INFO:Predict (train)
2020-06-13 14:53:15,798:INFO:Predict (train), time: 250.39262049691752 seconds
2020-06-13 14:53:16,208:INFO:Accuracy (train): 0.6669763125130829
2020-06-13 14:53:16,216:INFO:Predict probabilities (train)
2020-06-13 14:57:30,856:INFO:Predict probabilities (train), time: 254.63956191623583 seconds
2020-06-13 14:57:33,227:INFO:ROC AUC (train): 0.7347529300844625
2020-06-13 14:57:34,831:INFO:Create ROC plot for train
2020-06-13 14:57:34,910:INFO:Save ROC plot for train
2020-06-13 14:57:35,870:INFO:Predict (test)
2020-06-13 14:58:29,488:INFO:Predict (test), time: 53.61752395378426 seconds
2020-06-13 14:58:29,592:INFO:Accuracy (test): 0.6612660336255679
2020-06-13 14:58:29,600:INFO:Predict probabilities (test)
2020-06-13 14:59:23,923:INFO:Predict probabilities (test), time: 54.322334768716246 seconds
2020-06-13 14:59:24,492:INFO:ROC AUC (test): 0.726779173416058
2020-06-13 14:59:24,858:INFO:Create ROC plot for test
2020-06-13 14:59:24,892:INFO:Save ROC plot for test
2020-06-13 14:59:25,447:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-13 14:59:27,637:INFO:Training set shape (3568593, 72), test set shape (3568593, 72); total shape (7137186, 72)
2020-06-13 14:59:27,637:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-13 14:59:27,638:INFO:Refit with half of the training set
2020-06-13 16:30:29,656:INFO:Refit with half of the training set, time: 5462.0171028748155 seconds
2020-06-13 16:30:29,665:INFO:Predict (train_50)
2020-06-13 16:32:38,149:INFO:Predict (train_50), time: 128.4834035402164 seconds
2020-06-13 16:32:38,355:INFO:Accuracy (train_50): 0.669168773239201
2020-06-13 16:32:38,363:INFO:Predict probabilities (train_50)
2020-06-13 16:34:46,348:INFO:Predict probabilities (train_50), time: 127.98473682394251 seconds
2020-06-13 16:34:47,466:INFO:ROC AUC (train_50): 0.7384810313145157
2020-06-13 16:34:48,200:INFO:Create ROC plot for train_50
2020-06-13 16:34:48,305:INFO:Save ROC plot for train_50
2020-06-13 16:34:48,974:INFO:Predict (test_50)
2020-06-13 16:36:57,035:INFO:Predict (test_50), time: 128.06086139101535 seconds
2020-06-13 16:36:57,243:INFO:Accuracy (test_50): 0.6582224422902808
2020-06-13 16:36:57,251:INFO:Predict probabilities (test_50)
2020-06-13 16:39:04,828:INFO:Predict probabilities (test_50), time: 127.57685639010742 seconds
2020-06-13 16:39:05,939:INFO:ROC AUC (test_50): 0.7223919069858447
2020-06-13 16:39:06,693:INFO:Create ROC plot for test_50
2020-06-13 16:39:06,741:INFO:Save ROC plot for test_50
2020-06-13 16:39:07,413:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-13 16:39:09,512:INFO:Training set shape (5352889, 72), test set shape (1784297, 72); total shape (7137186, 72)
2020-06-13 16:39:09,512:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-13 16:39:09,513:INFO:Refit with 3/4 of the training set
2020-06-13 19:07:44,345:INFO:Refit with 3/4 of the training set, time: 8914.831656268798 seconds
2020-06-13 19:07:44,354:INFO:Predict (train_75)
2020-06-13 19:10:54,945:INFO:Predict (train_75), time: 190.59135540714487 seconds
2020-06-13 19:10:55,258:INFO:Accuracy (train_75): 0.6676818816904292
2020-06-13 19:10:55,266:INFO:Predict probabilities (train_75)
2020-06-13 19:14:05,683:INFO:Predict probabilities (train_75), time: 190.41726660402492 seconds
2020-06-13 19:14:07,403:INFO:ROC AUC (train_75): 0.7362573694111512
2020-06-13 19:14:08,557:INFO:Create ROC plot for train_75
2020-06-13 19:14:08,621:INFO:Save ROC plot for train_75
2020-06-13 19:14:09,428:INFO:Predict (test_75)
2020-06-13 19:15:02,216:INFO:Predict (test_75), time: 52.787151116877794 seconds
2020-06-13 19:15:02,319:INFO:Accuracy (test_75): 0.6604556304247555
2020-06-13 19:15:02,327:INFO:Predict probabilities (test_75)
2020-06-13 19:15:54,843:INFO:Predict probabilities (test_75), time: 52.51580855296925 seconds
2020-06-13 19:15:55,345:INFO:ROC AUC (test_75): 0.7253266398440397
2020-06-13 19:15:55,675:INFO:Create ROC plot for test_75
2020-06-13 19:15:55,706:INFO:Save ROC plot for test_75
2020-06-13 19:15:56,204:INFO:Create bar chart plot for fit
2020-06-13 19:15:56,218:INFO:Save bar chart plot for fit
2020-06-13 19:15:56,531:INFO:Create grouped bar chart plot for accuracy
2020-06-13 19:15:56,548:INFO:Save grouped bar chart plot for accuracy
2020-06-13 19:15:56,882:INFO:Create grouped bar chart plot for roc
2020-06-13 19:15:56,898:INFO:Save grouped bar chart plot for roc
2020-06-13 19:15:57,229:INFO:Final refit with the whole data set
2020-06-13 22:55:48,876:INFO:Final refit with the whole data set, time: 13191.646632371936 seconds
2020-06-13 22:55:48,886:INFO:Write refitted final model pickle
2020-06-13 22:55:48,904:INFO:Write training times in a CSV file
2020-06-13 22:55:48,911:INFO:FINISHED TRAINING --- r2, AdaBoostClassifier
2020-06-14 00:55:49,719:INFO:STARTING PREDICTION --- r2, AdaBoostClassifier
2020-06-14 00:55:49,719:INFO:Number of cores: 10, NUMEXPR_MAX_THREADS = 10
2020-06-14 00:55:49,729:INFO:Load data set csv file
2020-06-14 00:56:39,758:INFO:Load data set csv file, time: 50.02954033901915 seconds
2020-06-14 00:56:39,760:INFO:Dataset shape: (7853253, 82)
2020-06-14 00:56:47,164:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-14 00:56:47,164:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-14 00:56:47,165:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-14 00:56:47,165:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-14 00:56:47,360:INFO:Load pipeline pickle
2020-06-14 00:56:47,421:INFO:Pipeline transform
2020-06-14 01:00:08,370:INFO:Pipeline transform, time: 200.94882151624188 seconds
2020-06-14 01:00:15,365:INFO:Transformed data set shape: (7853253, 72)
2020-06-14 01:00:15,374:INFO:Load model pickle
2020-06-14 01:00:15,396:INFO:Predict probabilities
2020-06-14 01:04:58,077:INFO:Predict probabilities, time: 282.68160262005404 seconds
2020-06-14 01:04:58,116:INFO:Write predictions in a CSV file
2020-06-14 01:05:16,716:INFO:Write predictions in a CSV file, time: 18.599855293054134 seconds
2020-06-14 01:05:16,724:INFO:Write prediction times in a CSV file
2020-06-14 01:05:16,730:INFO:FINISHED PREDICTION --- r2, AdaBoostClassifier
