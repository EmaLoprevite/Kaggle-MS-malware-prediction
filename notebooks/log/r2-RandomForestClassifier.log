2020-06-12 17:30:32,652:INFO:STARTING TRAINING --- r2, RandomForestClassifier
2020-06-12 17:30:32,652:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-12 17:30:32,663:INFO:Load data set csv file
2020-06-12 17:31:34,444:INFO:Load data set csv file, time: 61.78111702622846 seconds
2020-06-12 17:31:34,446:INFO:Dataset shape: (8921483, 83)
2020-06-12 17:31:43,317:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-12 17:31:43,318:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-12 17:31:43,318:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-12 17:31:43,319:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-12 17:31:43,607:INFO:Full pipeline
2020-06-12 17:35:52,023:INFO:Full pipeline, time: 248.41578963119537 seconds
2020-06-12 17:36:00,529:INFO:Write pipeline pickle
2020-06-12 17:36:00,535:INFO:Transformed data set shape: (8921483, 72)
2020-06-12 17:36:00,550:INFO:Splitting tranformed data set: train 0.8, test 0.2
2020-06-12 17:36:09,589:INFO:Training set shape (7137186, 72), test set shape (1784297, 72); total shape (8921483, 72)
2020-06-12 17:36:09,590:INFO:Training labels shape (7137186,), test labels shape (1784297,); total labels shape (8921483,)
2020-06-12 17:36:09,622:INFO:GridSearchCV
2020-06-12 20:22:16,041:INFO:GridSearchCV, time: 9966.419147736859 seconds
2020-06-12 20:22:16,051:INFO:Write GridSearchCV pickle
2020-06-12 20:22:16,065:INFO:CV results: {'mean_fit_time': array([5912.95552554, 6498.82403908, 6317.45208597]), 'std_fit_time': array([441.12290801, 149.06236485, 472.19247815]), 'mean_score_time': array([8.24272642, 5.79587116, 6.75381718]), 'std_score_time': array([1.82548813, 0.42938627, 2.02160451]), 'param_n_estimators': masked_array(data=[110, 120, 130],
             mask=[False, False, False],
       fill_value='?',
            dtype=object), 'params': [{'n_estimators': 110}, {'n_estimators': 120}, {'n_estimators': 130}], 'split0_test_score': array([0.68643815, 0.68651994, 0.68648919]), 'split1_test_score': array([0.68553912, 0.68555806, 0.68561646]), 'split2_test_score': array([0.68643536, 0.68646663, 0.68648229]), 'split3_test_score': array([0.68508259, 0.68512493, 0.68516501]), 'split4_test_score': array([0.68509289, 0.68511278, 0.68508984]), 'mean_test_score': array([0.68571762, 0.68575647, 0.68576856]), 'std_test_score': array([0.00060987, 0.00062286, 0.00061266]), 'rank_test_score': array([3, 2, 1], dtype=int32), 'split0_train_score': array([0.68568339, 0.68576457, 0.68572295]), 'split1_train_score': array([0.68609727, 0.68611079, 0.68616866]), 'split2_train_score': array([0.685906  , 0.6859405 , 0.68595494]), 'split3_train_score': array([0.68569097, 0.68573679, 0.68577647]), 'split4_train_score': array([0.68613988, 0.68615652, 0.68613377]), 'mean_train_score': array([0.6859035 , 0.68594183, 0.68595136]), 'std_train_score': array([0.00019342, 0.00017211, 0.0001807 ])}
2020-06-12 20:22:16,078:INFO:Best score: 0.6857685589810685
2020-06-12 20:22:16,084:INFO:Refit time with the whole training set: 3165.211133480072 seconds
2020-06-12 20:22:16,090:INFO:Best parameters: {'n_estimators': 130}
2020-06-12 20:22:16,097:INFO:Best estimator: RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion='gini', max_depth=13, max_features=72,
                       max_leaf_nodes=83, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=130, n_jobs=4,
                       oob_score=False, random_state=25519, verbose=0,
                       warm_start=False)
2020-06-12 20:22:16,296:INFO:Predict (train)
2020-06-12 20:22:40,942:INFO:Predict (train), time: 24.645544284954667 seconds
2020-06-12 20:22:41,356:INFO:Accuracy (train): 0.6286910555504649
2020-06-12 20:22:41,364:INFO:Predict probabilities (train)
2020-06-12 20:23:06,044:INFO:Predict probabilities (train), time: 24.679497907869518 seconds
2020-06-12 20:23:08,000:INFO:ROC AUC (train): 0.6857301435722662
2020-06-12 20:23:09,105:INFO:Create ROC plot for train
2020-06-12 20:23:09,125:INFO:Save ROC plot for train
2020-06-12 20:23:09,498:INFO:Predict (test)
2020-06-12 20:23:15,484:INFO:Predict (test), time: 5.985527958255261 seconds
2020-06-12 20:23:15,592:INFO:Accuracy (test): 0.6276443887985016
2020-06-12 20:23:15,600:INFO:Predict probabilities (test)
2020-06-12 20:23:21,572:INFO:Predict probabilities (test), time: 5.971350369974971 seconds
2020-06-12 20:23:22,008:INFO:ROC AUC (test): 0.6849684783934029
2020-06-12 20:23:22,240:INFO:Create ROC plot for test
2020-06-12 20:23:22,258:INFO:Save ROC plot for test
2020-06-12 20:23:22,630:INFO:Splitting tranformed data set: train 0.5, test 0.5
2020-06-12 20:23:24,760:INFO:Training set shape (3568593, 72), test set shape (3568593, 72); total shape (7137186, 72)
2020-06-12 20:23:24,761:INFO:Training labels shape (3568593,), test labels shape (3568593,); total labels shape (7137186,)
2020-06-12 20:23:24,762:INFO:Refit with half of the training set
2020-06-12 20:52:12,149:INFO:Refit with half of the training set, time: 1727.3864319953136 seconds
2020-06-12 20:52:12,158:INFO:Predict (train_50)
2020-06-12 20:52:23,682:INFO:Predict (train_50), time: 11.524117957800627 seconds
2020-06-12 20:52:23,886:INFO:Accuracy (train_50): 0.6296907492672883
2020-06-12 20:52:23,894:INFO:Predict probabilities (train_50)
2020-06-12 20:52:35,191:INFO:Predict probabilities (train_50), time: 11.296765991020948 seconds
2020-06-12 20:52:36,126:INFO:ROC AUC (train_50): 0.6861868661049739
2020-06-12 20:52:36,660:INFO:Create ROC plot for train_50
2020-06-12 20:52:36,679:INFO:Save ROC plot for train_50
2020-06-12 20:52:37,051:INFO:Predict (test_50)
2020-06-12 20:52:48,372:INFO:Predict (test_50), time: 11.320666419807822 seconds
2020-06-12 20:52:48,580:INFO:Accuracy (test_50): 0.629292833337957
2020-06-12 20:52:48,588:INFO:Predict probabilities (test_50)
2020-06-12 20:52:59,901:INFO:Predict probabilities (test_50), time: 11.312670670915395 seconds
2020-06-12 20:53:00,842:INFO:ROC AUC (test_50): 0.6856717843004938
2020-06-12 20:53:01,380:INFO:Create ROC plot for test_50
2020-06-12 20:53:01,399:INFO:Save ROC plot for test_50
2020-06-12 20:53:01,773:INFO:Splitting tranformed data set: train 0.75, test 0.25
2020-06-12 20:53:03,901:INFO:Training set shape (5352889, 72), test set shape (1784297, 72); total shape (7137186, 72)
2020-06-12 20:53:03,902:INFO:Training labels shape (5352889,), test labels shape (1784297,); total labels shape (7137186,)
2020-06-12 20:53:03,902:INFO:Refit with 3/4 of the training set
2020-06-12 21:34:30,004:INFO:Refit with 3/4 of the training set, time: 2486.1014668461867 seconds
2020-06-12 21:34:30,013:INFO:Predict (train_75)
2020-06-12 21:34:47,803:INFO:Predict (train_75), time: 17.79042909387499 seconds
2020-06-12 21:34:48,122:INFO:Accuracy (train_75): 0.6292392762114066
2020-06-12 21:34:48,132:INFO:Predict probabilities (train_75)
2020-06-12 21:35:05,984:INFO:Predict probabilities (train_75), time: 17.852002655621618 seconds
2020-06-12 21:35:07,403:INFO:ROC AUC (train_75): 0.6858339543321839
2020-06-12 21:35:08,202:INFO:Create ROC plot for train_75
2020-06-12 21:35:08,220:INFO:Save ROC plot for train_75
2020-06-12 21:35:08,589:INFO:Predict (test_75)
2020-06-12 21:35:14,486:INFO:Predict (test_75), time: 5.897363432217389 seconds
2020-06-12 21:35:14,593:INFO:Accuracy (test_75): 0.628279933217396
2020-06-12 21:35:14,601:INFO:Predict probabilities (test_75)
2020-06-12 21:35:20,278:INFO:Predict probabilities (test_75), time: 5.677519482560456 seconds
2020-06-12 21:35:20,718:INFO:ROC AUC (test_75): 0.6849072271790239
2020-06-12 21:35:20,971:INFO:Create ROC plot for test_75
2020-06-12 21:35:20,988:INFO:Save ROC plot for test_75
2020-06-12 21:35:21,355:INFO:Create bar chart plot for fit
2020-06-12 21:35:21,370:INFO:Save bar chart plot for fit
2020-06-12 21:35:21,678:INFO:Create grouped bar chart plot for accuracy
2020-06-12 21:35:21,695:INFO:Save grouped bar chart plot for accuracy
2020-06-12 21:35:22,035:INFO:Create grouped bar chart plot for roc
2020-06-12 21:35:22,053:INFO:Save grouped bar chart plot for roc
2020-06-12 21:35:22,393:INFO:Final refit with the whole data set
2020-06-12 22:37:36,543:INFO:Final refit with the whole data set, time: 3734.1498048370704 seconds
2020-06-12 22:37:36,551:INFO:Write refitted final model pickle
2020-06-12 22:37:36,569:INFO:Write training times in a CSV file
2020-06-12 22:37:36,576:INFO:FINISHED TRAINING --- r2, RandomForestClassifier
2020-06-13 01:42:15,839:INFO:STARTING PREDICTION --- r2, RandomForestClassifier
2020-06-13 01:42:15,839:INFO:Number of cores: 20, NUMEXPR_MAX_THREADS = 20
2020-06-13 01:42:15,850:INFO:Load data set csv file
2020-06-13 01:43:10,611:INFO:Load data set csv file, time: 54.75998782692477 seconds
2020-06-13 01:43:10,612:INFO:Dataset shape: (7853253, 82)
2020-06-13 01:43:18,311:INFO:Numeric columns: ['OsBuild', 'OsSuite', 'Census_ProcessorCoreCount', 'Census_PrimaryDiskTotalCapacity', 'Census_TotalPhysicalRAM', 'Census_InternalPrimaryDiagonalDisplaySizeInInches', 'Census_InternalPrimaryDisplayResolutionHorizontal', 'Census_InternalPrimaryDisplayResolutionVertical', 'Census_InternalBatteryNumberOfCharges', 'Census_OSBuildNumber', 'Census_OSBuildRevision']
2020-06-13 01:43:18,311:INFO:Boolen columns: ['IsSxsPassiveMode', 'HasTpm', 'IsProtected', 'SMode', 'Firewall', 'Census_HasOpticalDiskDrive', 'Census_IsFlightingInternal', 'Census_IsFlightsDisabled', 'Census_ThresholdOptIn', 'Census_IsSecureBootEnabled', 'Census_IsWIMBootEnabled', 'Census_IsTouchEnabled', 'Census_IsPenCapable', 'Census_IsAlwaysOnAlwaysConnectedCapable', 'Wdft_IsGamer']
2020-06-13 01:43:18,312:INFO:Numeric bin columns: ['RtpStateBitfield', 'DefaultBrowsersIdentifier', 'AVProductStatesIdentifier', 'AVProductsInstalled', 'AVProductsEnabled', 'CountryIdentifier', 'CityIdentifier', 'OrganizationIdentifier', 'GeoNameIdentifier', 'LocaleEnglishNameIdentifier', 'IeVerIdentifier', 'Census_OEMNameIdentifier', 'Census_OEMModelIdentifier', 'Census_ProcessorManufacturerIdentifier', 'Census_ProcessorModelIdentifier', 'Census_OSInstallLanguageIdentifier', 'Census_OSUILocaleIdentifier', 'Census_FirmwareManufacturerIdentifier', 'Census_FirmwareVersionIdentifier', 'Wdft_RegionIdentifier']
2020-06-13 01:43:18,312:INFO:String columns: ['ProductName', 'EngineVersion', 'AppVersion', 'AvSigVersion', 'Platform', 'Processor', 'OsVer', 'OsPlatformSubRelease', 'OsBuildLab', 'SkuEdition', 'SmartScreen', 'Census_MDC2FormFactor', 'Census_PrimaryDiskTypeName', 'Census_ChassisTypeName', 'Census_PowerPlatformRoleName', 'Census_InternalBatteryType', 'Census_OSVersion', 'Census_OSArchitecture', 'Census_OSBranch', 'Census_OSEdition', 'Census_OSSkuName', 'Census_OSInstallTypeName', 'Census_OSWUAutoUpdateOptionsName', 'Census_GenuineStateName', 'Census_ActivationChannel', 'Census_FlightRing']
2020-06-13 01:43:18,527:INFO:Load pipeline pickle
2020-06-13 01:43:18,601:INFO:Pipeline transform
2020-06-13 01:46:49,625:INFO:Pipeline transform, time: 211.02304269885644 seconds
2020-06-13 01:46:56,986:INFO:Transformed data set shape: (7853253, 72)
2020-06-13 01:46:56,993:INFO:Load model pickle
2020-06-13 01:46:57,016:INFO:Predict probabilities
2020-06-13 01:47:22,596:INFO:Predict probabilities, time: 25.579473338089883 seconds
2020-06-13 01:47:22,659:INFO:Write predictions in a CSV file
2020-06-13 01:47:41,673:INFO:Write predictions in a CSV file, time: 19.01398178189993 seconds
2020-06-13 01:47:41,682:INFO:Write prediction times in a CSV file
2020-06-13 01:47:41,688:INFO:FINISHED PREDICTION --- r2, RandomForestClassifier
